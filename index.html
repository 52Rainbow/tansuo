<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Êï∞Â≠óÁßòÂ¢ÉÔºöÁßëÊäÄËß£Ë∞ú‰πãÊóÖ</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #0f0f1a;
            color: #00ff88;
            font-family: 'Courier New', monospace;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        #game-container {
            width: 800px;
            height: 600px;
            position: relative;
            background-color: #0a0a12;
            border: 2px solid #00ff88;
            border-radius: 5px;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.5);
        }
        #splash-screen {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: rgba(15, 15, 26, 0.9);
            z-index: 100;
            transition: opacity 1s;
        }
        #title {
            font-size: 2.5em;
            margin-bottom: 20px;
            text-shadow: 0 0 10px #00ff88;
            letter-spacing: 3px;
        }
        #start-btn {
            padding: 10px 20px;
            font-size: 1.2em;
            background-color: #00ff88;
            color: #0a0a12;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        #start-btn:hover {
            background-color: #00cc7a;
            transform: scale(1.05);
            box-shadow: 0 0 15px #00ff88;
        }
        .loading-bar {
            width: 300px;
            height: 20px;
            background-color: #1a1a2e;
            border-radius: 10px;
            margin-top: 30px;
            overflow: hidden;
        }
        .loading-progress {
            height: 100%;
            width: 0%;
            background-color: #00ff88;
            transition: width 0.3s;
        }
        #game-map {
            position: absolute;
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            padding: 20px;
            box-sizing: border-box;
        }
        .map-title {
            font-size: 1.5em;
            margin-bottom: 10px;
            text-align: center;
        }
        #main-map {
            width: 100%;
            height: 70%;
            background-color: #0a0a12;
            border: 1px solid #00ff88;
            position: relative;
            overflow: auto;
            padding: 10px;
            box-sizing: border-box;
        }
        .map-node {
            position: absolute;
            width: 60px;
            height: 60px;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: rgba(10, 10, 18, 0.8);
            border: 2px solid #00ff88;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 0 10px rgba(0, 255, 136, 0.3);
        }
        .map-node:hover {
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(0, 255, 136, 0.8);
        }
        .map-node-locked {
            background-color: rgba(26, 26, 46, 0.8);
            border-color: #555;
            box-shadow: 0 0 5px rgba(85, 85, 85, 0.5);
        }
        .map-node-locked:hover {
            transform: none;
            box-shadow: 0 0 5px rgba(85, 85, 85, 0.5);
        }
        #game-ui {
            display: flex;
            height: 30%;
            padding: 10px;
            box-sizing: border-box;
        }
        #time-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: rgba(10, 10, 18, 0.8);
            border: 1px solid #00ff88;
            border-radius: 5px;
            margin-right: 10px;
            padding: 10px;
        }
        #time-display {
            font-size: 1.2em;
            margin-bottom: 10px;
        }
        #time-toggle {
            padding: 5px 10px;
            background-color: #00ff88;
            color: #0a0a12;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }
        #time-toggle:hover {
            background-color: #00cc7a;
        }
        #clue-panel {
            flex: 2;
            background-color: rgba(10, 10, 18, 0.8);
            border: 1px solid #00ff88;
            border-radius: 5px;
            margin-right: 10px;
            padding: 10px;
            overflow-y: auto;
        }
        #clue-title {
            font-size: 1.2em;
            margin-bottom: 10px;
            text-align: center;
        }
        .clue-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            padding: 5px;
            background-color: rgba(26, 26, 46, 0.8);
            border-radius: 3px;
        }
        .clue-icon {
            font-size: 1.2em;
            margin-right: 10px;
        }
        .clue-text {
            font-size: 0.9em;
        }
        #achievement-panel {
            flex: 1;
            background-color: rgba(10, 10, 18, 0.8);
            border: 1px solid #00ff88;
            border-radius: 5px;
            padding: 10px;
            overflow-y: auto;
        }
        #achievement-title {
            font-size: 1.2em;
            margin-bottom: 10px;
            text-align: center;
        }
        .achievement-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            padding: 5px;
            background-color: rgba(26, 26, 46, 0.8);
            border-radius: 3px;
        }
        .achievement-icon {
            font-size: 1.2em;
            margin-right: 10px;
        }
        .achievement-text {
            font-size: 0.9em;
        }
        .achievement-locked {
            opacity: 0.5;
        }
        #exploration-screen {
            position: absolute;
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            background-color: #0a0a12;
            z-index: 50;
            padding: 20px;
            box-sizing: border-box;
        }
        #exploration-header {
            height: 10%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 10px;
        }
        #location-name {
            font-size: 1.5em;
            font-weight: bold;
        }
        #back-btn {
            padding: 5px 10px;
            background-color: #00ff88;
            color: #0a0a12;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }
        #back-btn:hover {
            background-color: #00cc7a;
        }
        #exploration-content {
            height: 80%;
            overflow-y: auto;
            padding: 10px;
        }
        .exploration-node {
            width: 100%;
            height: 150px;
            margin-bottom: 20px;
            background-color: rgba(26, 26, 46, 0.8);
            border: 1px solid #00ff88;
            border-radius: 5px;
            display: flex;
            flex-direction: column;
            padding: 15px;
            box-sizing: border-box;
        }
        .node-title {
            font-size: 1.2em;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        .node-icon {
            font-size: 1.2em;
            margin-right: 10px;
        }
        .node-description {
            font-size: 0.9em;
            margin-bottom: 15px;
            color: #00ffcc;
        }
        .node-action {
            display: flex;
            justify-content: flex-end;
        }
        .action-btn {
            padding: 5px 15px;
            background-color: #00ff88;
            color: #0a0a12;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            margin-left: 10px;
        }
        .action-btn:hover {
            background-color: #00cc7a;
        }
        .node-completed {
            border-color: #00cc7a;
            position: relative;
        }
        .node-completed::after {
            content: "‚úì";
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 1.5em;
            color: #00cc7a;
        }
        #exploration-footer {
            height: 10%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #puzzle-screen {
            position: absolute;
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            background-color: #0a0a12;
            z-index: 60;
            padding: 20px;
            box-sizing: border-box;
        }
        #puzzle-header {
            height: 10%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 10px;
        }
        #puzzle-title {
            font-size: 1.5em;
            font-weight: bold;
        }
        #close-puzzle {
            padding: 5px 10px;
            background-color: #00ff88;
            color: #0a0a12;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }
        #close-puzzle:hover {
            background-color: #00cc7a;
        }
        #puzzle-content {
            height: 80%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .puzzle-description {
            width: 80%;
            font-size: 1em;
            margin-bottom: 20px;
            text-align: center;
            color: #00ffcc;
        }
        .puzzle-interface {
            width: 80%;
            height: 300px;
            background-color: rgba(26, 26, 46, 0.8);
            border: 1px solid #00ff88;
            border-radius: 5px;
            display: flex;
            flex-direction: column;
            padding: 20px;
            box-sizing: border-box;
        }
        .puzzle-input {
            width: 100%;
            height: 50px;
            margin-top: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #puzzle-answer {
            width: 70%;
            padding: 8px;
            font-size: 1em;
            background-color: #1a1a2e;
            color: #00ff88;
            border: 1px solid #00ff88;
            border-radius: 3px;
        }
        #submit-answer {
            padding: 8px 15px;
            background-color: #00ff88;
            color: #0a0a12;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            margin-left: 10px;
        }
        #submit-answer:hover {
            background-color: #00cc7a;
        }
        #modal {
            position: absolute;
            width: 100%;
            height: 100%;
            display: none;
            justify-content: center;
            align-items: center;
            background-color: rgba(10, 10, 18, 0.9);
            z-index: 200;
        }
        .modal-content {
            width: 60%;
            height: 40%;
            background-color: #0a0a12;
            border: 2px solid #00ff88;
            border-radius: 5px;
            display: flex;
            flex-direction: column;
            padding: 20px;
            box-sizing: border-box;
        }
        .modal-title {
            font-size: 1.5em;
            margin-bottom: 15px;
            text-align: center;
        }
        .modal-message {
            font-size: 1em;
            margin-bottom: 20px;
            text-align: center;
            color: #00ffcc;
        }
        .modal-btn {
            padding: 8px 20px;
            background-color: #00ff88;
            color: #0a0a12;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            margin: 0 auto;
            display: block;
        }
        .modal-btn:hover {
            background-color: #00cc7a;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <!-- Âä†ËΩΩÁïåÈù¢ -->
        <div id="splash-screen">
            <div id="title">Êï∞Â≠óÁßòÂ¢É</div>
            <div id="start-btn">ÂºÄÂßãÊé¢Á¥¢</div>
            <div class="loading-bar">
                <div class="loading-progress" id="loading-bar"></div>
            </div>
        </div>
        
        <!-- ‰∏ªÂú∞ÂõæÁïåÈù¢ -->
        <div id="game-map">
            <div class="map-title">Êï∞Â≠ó‰∏ñÁïåÂú∞Âõæ</div>
            <div id="main-map">
                <!-- ‰∏ªËäÇÁÇπ -->
                <div class="map-node" style="top: 50%; left: 50%;" data-node="main-hub">
                    üåê
                </div>
                <!-- Êï∞ÊçÆ‰∏≠ÂøÉËäÇÁÇπ -->
                <div class="map-node" style="top: 30%; left: 30%;" data-node="data-center">
                    üíæ
                </div>
                <!-- ÁΩëÁªúÂÆâÂÖ®ËäÇÁÇπ -->
                <div class="map-node" style="top: 30%; left: 70%;" data-node="security-hub">
                    üîí
                </div>
                <!-- ‰∫∫Â∑•Êô∫ËÉΩËäÇÁÇπ -->
                <div class="map-node" style="top: 70%; left: 30%;" data-node="ai-lab">
                    ü§ñ
                </div>
                <!-- ÂØÜÁ†ÅÂ≠¶ËäÇÁÇπ -->
                <div class="map-node" style="top: 70%; left: 70%;" data-node="crypto-vault">
                    ‚öñÔ∏è
                </div>
                
                <!-- ËøûÊé•Á∫ø -->
                <svg width="100%" height="100%" style="position: absolute; top: 0; left: 0; z-index: -1;">
                    <line x1="50%" y1="50%" x2="30%" y2="30%" stroke="#00ff88" stroke-width="2" stroke-dasharray="5,5"/>
                    <line x1="50%" y1="50%" x2="70%" y2="30%" stroke="#00ff88" stroke-width="2" stroke-dasharray="5,5"/>
                    <line x1="50%" y1="50%" x2="30%" y2="70%" stroke="#00ff88" stroke-width="2" stroke-dasharray="5,5"/>
                    <line x1="50%" y1="50%" x2="70%" y2="70%" stroke="#00ff88" stroke-width="2" stroke-dasharray="5,5"/>
                </svg>
            </div>
            
            <div id="game-ui">
                <div id="time-panel">
                    <div id="time-display">Á≥ªÁªüÊó∂Èó¥: ÁôΩÂ§©</div>
                    <button id="time-toggle">ÂàáÊç¢Êó∂Èó¥</button>
                </div>
                
                <div id="clue-panel">
                    <div id="clue-title">Â∑≤Êî∂ÈõÜÁ∫øÁ¥¢</div>
                    <div id="clues-container">
                        <!-- Á∫øÁ¥¢Â∞ÜÂú®ËøôÈáåÂä®ÊÄÅÊ∑ªÂä† -->
                    </div>
                </div>
                
                <div id="achievement-panel">
                    <div id="achievement-title">ÊàêÂ∞±</div>
                    <div id="achievements-container">
                        <!-- ÊàêÂ∞±Â∞ÜÂú®ËøôÈáåÂä®ÊÄÅÊ∑ªÂä† -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Êé¢Á¥¢ÁïåÈù¢ -->
        <div id="exploration-screen">
            <div id="exploration-header">
                <div id="location-name">‰ΩçÁΩÆÂêçÁß∞</div>
                <button id="back-btn">ËøîÂõûÂú∞Âõæ</button>
            </div>
            <div id="exploration-content">
                <!-- Êé¢Á¥¢ËäÇÁÇπÂ∞ÜÂú®ËøôÈáåÂä®ÊÄÅÊ∑ªÂä† -->
            </div>
            <div id="exploration-footer">
                <!-- È°µËÑöÂÜÖÂÆπ -->
            </div>
        </div>
        
        <!-- Ë∞úÈ¢òÁïåÈù¢ -->
        <div id="puzzle-screen">
            <div id="puzzle-header">
                <div id="puzzle-title">Ë∞úÈ¢òÊ†áÈ¢ò</div>
                <button id="close-puzzle">ÂÖ≥Èó≠</button>
            </div>
            <div id="puzzle-content">
                <div class="puzzle-description" id="puzzle-description">Ë∞úÈ¢òÊèèËø∞Â∞ÜÊòæÁ§∫Âú®ËøôÈáå</div>
                <div class="puzzle-interface" id="puzzle-interface">
                    <!-- Ë∞úÈ¢òÁïåÈù¢Â∞ÜÂú®ËøôÈáåÂä®ÊÄÅÊ∑ªÂä† -->
                </div>
                <div class="puzzle-input">
                    <input type="text" id="puzzle-answer" placeholder="ËæìÂÖ•Á≠îÊ°à">
                    <button id="submit-answer">Êèê‰∫§</button>
                </div>
            </div>
        </div>
        
        <!-- ÂºπÁ™ó -->
        <div id="modal">
            <div class="modal-content">
                <div class="modal-title" id="modal-title">Ê†áÈ¢ò</div>
                <div class="modal-message" id="modal-message">Ê∂àÊÅØÂ∞ÜÊòæÁ§∫Âú®ËøôÈáå</div>
                <button class="modal-btn" id="modal-btn">Á°ÆÂÆö</button>
            </div>
        </div>
    </div>

    <script>
        // Ê∏∏ÊàèÁä∂ÊÄÅ
        const gameState = {
            loaded: false,
            currentTime: 'day', // 'day' Êàñ 'night'
            currentLocation: null,
            clues: [],
            achievements: [],
            unlockedNodes: ['main-hub'],
            explorationProgress: {
                'main-hub': 0,
                'data-center': 0,
                'security-hub': 0,
                'ai-lab': 0,
                'crypto-vault': 0
            },
            puzzlesSolved: {
                'main-hub': [],
                'data-center': [],
                'security-hub': [],
                'ai-lab': [],
                'crypto-vault': []
            }
        };

        // ÊàêÂ∞±Êï∞ÊçÆ
        const achievementsData = [
            {
                id: 'hub-explorer',
                name: '‰∏≠ÂøÉÊû¢Á∫ΩÊé¢Á¥¢ËÄÖ',
                description: 'Êé¢Á¥¢‰∏ªËäÇÁÇπ',
                icon: 'üåê',
                difficulty: 1,
                hidden: false
            },
            {
                id: 'data-miner',
                name: 'Êï∞ÊçÆÁüøÂ∑•',
                description: 'Ëß£ÈîÅÊï∞ÊçÆ‰∏≠ÂøÉËäÇÁÇπ',
                icon: 'üíæ',
                difficulty: 1,
                hidden: false
            },
            {
                id: 'security-guru',
                name: 'ÂÆâÂÖ®‰∏ìÂÆ∂',
                description: 'Ëß£ÈîÅÁΩëÁªúÂÆâÂÖ®ËäÇÁÇπ',
                icon: 'üîí',
                difficulty: 1,
                hidden: false
            },
            {
                id: 'ai-pioneer',
                name: 'AI ÂÖàÈ©±',
                description: 'Ëß£ÈîÅ‰∫∫Â∑•Êô∫ËÉΩËäÇÁÇπ',
                icon: 'ü§ñ',
                difficulty: 1,
                hidden: false
            },
            {
                id: 'crypto-master',
                name: 'ÂØÜÁ†ÅÂ§ßÂ∏à',
                description: 'Ëß£ÈîÅÂØÜÁ†ÅÂ≠¶ËäÇÁÇπ',
                icon: 'üîê',
                difficulty: 1,
                hidden: false
            },
            {
                id: 'clue-collector',
                name: 'Á∫øÁ¥¢Êî∂ÈõÜËÄÖ',
                description: 'Êî∂ÈõÜ5Êù°Á∫øÁ¥¢',
                icon: 'üîç',
                difficulty: 2,
                hidden: false
            },
            {
                id: 'puzzle-solver',
                name: 'Ëß£Ë∞ú‰∏ìÂÆ∂',
                description: 'Ëß£ÂºÄ5‰∏™Ë∞úÈ¢ò',
                icon: 'üß©',
                difficulty: 2,
                hidden: false
            },
            {
                id: 'night-owl',
                name: 'Â§úÁå´Â≠ê',
                description: 'Âú®Â§úÈó¥Êé¢Á¥¢Êï∞Â≠ó‰∏ñÁïå',
                icon: 'üåô',
                difficulty: 2,
                hidden: true
            },
            {
                id: 'caesar-cracker',
                name: 'ÂáØÊííÂØÜÁ†ÅÁ†¥ËØëËÄÖ',
                description: 'Ëß£ÂºÄÂáØÊííÂØÜÁ†ÅË∞úÈ¢ò',
                icon: 'üîë',
                difficulty: 3,
                hidden: false
            },
            {
                id: 'binary-whiz',
                name: '‰∫åËøõÂà∂Â§ßÂ∏à',
                description: 'Ëß£ÂºÄ‰∫åËøõÂà∂Ë∞úÈ¢ò',
                icon: '1Ô∏è‚É£0Ô∏è‚É£',
                difficulty: 3,
                hidden: false
            },
            {
                id: 'regex-ninja',
                name: 'Ê≠£ÂàôË°®ËææÂºèÂøçËÄÖ',
                description: 'Ëß£ÂºÄÊ≠£ÂàôË°®ËææÂºèË∞úÈ¢ò',
                icon: 'üéØ',
                difficulty: 4,
                hidden: false
            },
            {
                id: 'rsa-cracker',
                name: 'RSA Á†¥Ëß£ËÄÖ',
                description: 'Ëß£ÂºÄ RSA ÂØÜÁ†ÅË∞úÈ¢ò',
                icon: 'üîí',
                difficulty: 5,
                hidden: true
            },
            {
                id: 'quantum-leap',
                name: 'ÈáèÂ≠êÈ£ûË∑É',
                description: 'Ëß£ÂºÄÈáèÂ≠êËÆ°ÁÆóË∞úÈ¢ò',
                icon: '‚öõÔ∏è',
                difficulty: 5,
                hidden: true
            },
            {
                id: 'perfect-explorer',
                name: 'ÂÆåÁæéÊé¢Á¥¢ËÄÖ',
                description: 'Êé¢Á¥¢ÊâÄÊúâËäÇÁÇπ',
                icon: 'üèÜ',
                difficulty: 5,
                hidden: true
            },
            {
                id: 'ultimate-solver',
                name: 'ÁªàÊûÅËß£Ë∞úËÄÖ',
                description: 'Ëß£ÂºÄÊâÄÊúâË∞úÈ¢ò',
                icon: 'üëë',
                difficulty: 5,
                hidden: true
            }
        ];

        // Á∫øÁ¥¢Êï∞ÊçÆ
        const cluesData = [
            {
                id: 'hub-clue-1',
                name: 'ÁΩëÁªúÂü∫Á°Ä',
                description: 'IP Âú∞ÂùÄÁî±Âõõ‰∏™ 0-255 ÁöÑÊï∞Â≠óÁªÑÊàêÔºåÂ¶Ç 192.168.1.1',
                icon: 'üåê'
            },
            {
                id: 'data-clue-1',
                name: 'Êï∞ÊçÆÂ≠òÂÇ®',
                description: '1 TB = 1024 GB = 1,099,511,627,776 Â≠óËäÇ',
                icon: 'üíæ'
            },
            {
                id: 'security-clue-1',
                name: 'Âä†ÂØÜÂü∫Á°Ä',
                description: 'ÂØπÁß∞Âä†ÂØÜ‰ΩøÁî®Âêå‰∏ÄÊääÂØÜÈí•Âä†ÂØÜÂíåËß£ÂØÜÊï∞ÊçÆ',
                icon: 'üîí'
            },
            {
                id: 'ai-clue-1',
                name: 'Êú∫Âô®Â≠¶‰π†',
                description: 'AI ËÆ≠ÁªÉÈúÄË¶ÅÂ§ßÈáèÊ†áÊ≥®Êï∞ÊçÆÊù•ÊèêÈ´òÂáÜÁ°ÆÊÄß',
                icon: 'ü§ñ'
            },
            {
                id: 'crypto-clue-1',
                name: 'ÂìàÂ∏åÂáΩÊï∞',
                description: 'SHA-256 ÁîüÊàê 64 Â≠óÁ¨¶ÁöÑÂçÅÂÖ≠ËøõÂà∂ÂìàÂ∏åÂÄº',
                icon: 'üîê'
            }
        ];

        // Êé¢Á¥¢ËäÇÁÇπÊï∞ÊçÆ
        const explorationNodesData = {
            'main-hub': [
                {
                    id: 'hub-node-1',
                    title: 'ÁΩëÁªú‰∏≠ÂøÉ',
                    description: 'ËøôÈáåÊòØÊï∞Â≠ó‰∏ñÁïåÁöÑ‰∏≠ÂøÉÊû¢Á∫ΩÔºåËøûÊé•ÁùÄÂêÑ‰∏™ÈáçË¶ÅËäÇÁÇπ„ÄÇ‰Ω†Ê≥®ÊÑèÂà∞Â¢ô‰∏äÁöÑÊòæÁ§∫Â±è‰∏çÊñ≠Èó™ÁÉÅÁùÄÁΩëÁªúÊµÅÈáèÊï∞ÊçÆ„ÄÇ',
                    action: 'Êü•ÁúãÊï∞ÊçÆÊµÅÈáè',
                    puzzle: {
                        type: 'caesar',
                        difficulty: 1,
                        description: 'ÊòæÁ§∫Â±è‰∏äÂá∫Áé∞‰∫Ü‰∏Ä‰∏≤Âä†ÂØÜÊñáÂ≠óÔºöUifsf jt b tfdsfu dpefefs ibufdmfjoft. Ëß£ÂØÜËøô‰∏≤ÊñáÂ≠óËé∑ÂèñÁ∫øÁ¥¢„ÄÇ',
                        answer: 'This is a simple caesar cipher encryption.'
                    },
                    clue: 'hub-clue-1',
                    achievement: 'hub-explorer'
                },
                {
                    id: 'hub-node-2',
                    title: '‰ø°ÊÅØÂÖ¨ÂëäÊùø',
                    description: 'ÂÖ¨ÂëäÊùø‰∏äË¥¥Êª°‰∫ÜÂêÑÁßçÊï∞Â≠ó‰∏ñÁïåÁöÑÈÄöÁü•„ÄÇÂÖ∂‰∏≠‰∏ÄÂº†ÁâπÂà´ÊòæÁúºÔºå‰∏äÈù¢ÂÜôÁùÄ"ÂØªÊâæÈöêËóèÂú®ÁΩëÁªúÊ∑±Â§ÑÁöÑÂè§ËÄÅÂçèËÆÆ...".',
                    action: 'ÈòÖËØªÂÖ¨Âëä',
                    puzzle: null,
                    clue: null,
                    achievement: null
                }
            ],
            'data-center': [
                {
                    id: 'dc-node-1',
                    title: 'Â≠òÂÇ®ÈòµÂàó',
                    description: '‰∏ÄÊéíÊéíÊúçÂä°Âô®Èó™ÁÉÅÁùÄËìùËâ≤ÂÖâËäíÔºåËøôÈáåÂ≠òÂÇ®ÁùÄÊï∞Â≠ó‰∏ñÁïåÁöÑÊâÄÊúâÊï∞ÊçÆ„ÄÇ‰∏ÄÂè∞ÊúçÂä°Âô®‰∏äÁöÑÊåáÁ§∫ÁÅØÂºÇÂ∏∏Èó™ÁÉÅ„ÄÇ',
                    action: 'Ê£ÄÊü•ÂºÇÂ∏∏ÊúçÂä°Âô®',
                    puzzle: {
                        type: 'binary',
                        difficulty: 2,
                        description: 'ÊúçÂä°Âô®Â±èÂπï‰∏äÊòæÁ§∫‰∏Ä‰∏≤‰∫åËøõÂà∂‰ª£Á†ÅÔºö01001000 01100101 01101100 01101100 01101111 00100000 01010111 01101111 011100kl. ËΩ¨Êç¢Ëøô‰∏≤‰∫åËøõÂà∂Ëé∑ÂèñÁ∫øÁ¥¢„ÄÇ',
                        answer: 'Hello World'
                    },
                    clue: 'data-clue-1',
                    achievement: 'data-miner'
                },
                {
                    id: 'dc-node-2',
                    title: 'Êï∞ÊçÆÂ§á‰ªΩÁ´ô',
                    description: 'ËøôÈáåÊòØÊï∞ÊçÆÂ§á‰ªΩÁöÑÊ†∏ÂøÉÂå∫ÂüüÔºåÂ§ö‰∏™Á£ÅÂ∏¶Â≠òÂÇ®Ë£ÖÁΩÆÊï¥ÈΩêÊéíÂàó„ÄÇ‰∏Ä‰∏™Ë£ÖÁΩÆ‰∏äÁöÑÊ†áÁ≠æ‰ºº‰πéË¢´ÈÉ®ÂàÜÊì¶Èô§„ÄÇ',
                    action: 'Ê£ÄÊü•Á£ÅÂ∏¶Ê†áÁ≠æ',
                    puzzle: {
                        type: 'regex',
                        difficulty: 3,
                        description: 'Ê†áÁ≠æ‰∏äÊÆãÁïôÁùÄÈÉ®ÂàÜÁºñÂè∑ÔºöD[T][A-P]_[0-9]{3}_[A-Z]{3}. ‰ΩøÁî®Ê≠£ÂàôË°®ËææÂºèÊâæÂá∫Ê≠£Á°ÆÁöÑÂ§á‰ªΩÁºñÂè∑„ÄÇ',
                        answer: 'DATA_123_ABC'
                    },
                    clue: 'data-clue-2',
                    achievement: null
                }
            ],
            'security-hub': [
                {
                    id: 'sec-node-1',
                    title: 'Èò≤ÁÅ´Â¢ôÊéßÂà∂Âè∞',
                    description: 'ËøôÈáåÊòØÁΩëÁªúÂÆâÂÖ®ÁöÑÂÆàÊä§ËÄÖÔºå‰∏ÄÂè∞ÁªàÁ´ØÂ±èÂπïÊòæÁ§∫ÁùÄ‰∏çÊñ≠Â∞ùËØïÂÖ•‰æµÁöÑ IP Âú∞ÂùÄ„ÄÇÂÖ∂‰∏≠Êúâ‰∏Ä‰∏™ IP ÊòæÂæóÊ†ºÂ§ñÂºÇÂ∏∏„ÄÇ',
                    action: 'ÂàÜÊûêÂºÇÂ∏∏ IP',
                    puzzle: {
                        type: 'ip-calc',
                        difficulty: 2,
                        description: 'ÂºÇÂ∏∏ IP: 192.168.1.255/24. ËÆ°ÁÆóËøô‰∏™ IP ÁöÑÁΩëÁªúÂú∞ÂùÄ„ÄÅÂπøÊí≠Âú∞ÂùÄÂíåÂèØÁî®‰∏ªÊú∫ËåÉÂõ¥„ÄÇ',
                        answer: 'Network:192.168.1.0 Broadcast:192.168.1.255 Hosts:1-254'
                    },
                    clue: 'security-clue-1',
                    achievement: 'security-guru'
                },
                {
                    id: 'sec-node-2',
                    title: 'ÂÖ•‰æµÊ£ÄÊµãÁ≥ªÁªü',
                    description: 'IDS Á≥ªÁªü‰∏çÊñ≠ÂèëÂá∫Ë≠¶Êä•ÔºåÊòæÁ§∫ÊúâÊú™Áü•ÊîªÂáªÊ®°Âºè„ÄÇ‰∏Ä‰∏™ÂèØÁñëÊñá‰ª∂Ë¢´Êã¶Êà™ÔºåÊñá‰ª∂ÂêçÊòØÂä†ÂØÜÁöÑ„ÄÇ',
                    action: 'Ëß£ÂØÜÊñá‰ª∂Âêç',
                    puzzle: {
                        type: 'base64',
                        difficulty: 3,
                        description: 'Âä†ÂØÜÊñá‰ª∂Âêç: QW5jb3Z1cnJhbl9maWxlLnR4dA==. Ëß£Á†ÅËøô‰∏™ Base64 Â≠óÁ¨¶‰∏≤Ëé∑ÂèñÁ∫øÁ¥¢„ÄÇ',
                        answer: 'Ancovurral_file.txt'
                    },
                    clue: 'security-clue-2',
                    achievement: null
                }
            ],
            'ai-lab': [
                {
                    id: 'ai-node-1',
                    title: 'Êú∫Âô®Â≠¶‰π†Ê®°Âûã',
                    description: 'ËøôÈáåÊòØ AI Á†îÁ©∂ÁöÑÊ†∏ÂøÉÔºåÂ§ö‰∏™Á•ûÁªèÁΩëÁªúÊ®°ÂûãÊ≠£Âú®ËÆ≠ÁªÉ‰∏≠„ÄÇ‰∏Ä‰∏™Ê®°ÂûãÁöÑËæìÂá∫Êó•Âøó‰ºº‰πéÊöóÁ§∫ÁùÄ‰ªÄ‰πà„ÄÇ',
                    action: 'Êü•ÁúãÊ®°ÂûãÊó•Âøó',
                    puzzle: {
                        type: 'sequence',
                        difficulty: 3,
                        description: 'Êó•ÂøóÊòæÁ§∫‰∏Ä‰∏™Â∫èÂàóÔºö0, 1, 1, 2, 3, 5, 8, 13, ?. ÁåúÂá∫‰∏ã‰∏Ä‰∏™Êï∞Â≠óËé∑ÂèñÁ∫øÁ¥¢„ÄÇ',
                        answer: '21'
                    },
                    clue: 'ai-clue-1',
                    achievement: 'ai-pioneer'
                },
                {
                    id: 'ai-node-2',
                    title: 'AI ËÆ≠ÁªÉÊï∞ÊçÆ',
                    description: 'ËÆ≠ÁªÉÊï∞ÊçÆÈõÜÂ≠òÂÇ®Âú®ËøôÈáåÔºå‰∏Ä‰∏™Ê†áÊ≥®ÈîôËØØÁöÑÊï∞ÊçÆÊ†∑Êú¨ÂºïËµ∑‰∫Ü‰Ω†ÁöÑÊ≥®ÊÑè„ÄÇ',
                    action: 'Ê£ÄÊü•Êï∞ÊçÆÊ†∑Êú¨',
                    puzzle: {
                        type: 'xor',
                        difficulty: 4,
                        description: 'Êï∞ÊçÆÊ†∑Êú¨ÊòæÁ§∫ÔºöXOR Èó®ÁöÑËæìÂá∫ÊòØ ? ÂΩìËæìÂÖ•ÊòØ 1 Âíå 1. ÂõûÁ≠îËøô‰∏™ÈÄªËæëÈóÆÈ¢òËé∑ÂèñÁ∫øÁ¥¢„ÄÇ',
                        answer: '0'
                    },
                    clue: 'ai-clue-2',
                    achievement: null
                }
            ],
            'crypto-vault': [
                {
                    id: 'crypto-node-1',
                    title: 'ÂìàÂ∏åÁÆóÊ≥ïÂ±ïÁ§∫',
                    description: 'ËøôÈáåÂ±ïÁ§∫‰∫ÜÂêÑÁßçÂìàÂ∏åÁÆóÊ≥ïÁöÑÂ∑•‰ΩúÂéüÁêÜ„ÄÇ‰∏Ä‰∏™ÊºîÁ§∫Â±èÂπï‰∏äÁöÑ MD5 ÂìàÂ∏åÂÄº‰ºº‰πéÊúâÈóÆÈ¢ò„ÄÇ',
                    action: 'Ê£ÄÊü•ÂìàÂ∏åÂÄº',
                    puzzle: {
                        type: 'md5',
                        difficulty: 3,
                        description: 'ÂìàÂ∏åÂÄº: 68e1f5a3f9f8c9f8c9f8c9f8c9f8c9f8. ÊâæÂá∫Ëøô‰∏™ MD5 ÂìàÂ∏åÂØπÂ∫îÁöÑÂéüÂßãÊñáÊú¨„ÄÇ',
                        answer: 'password123'
                    },
                    clue: 'crypto-clue-1',
                    achievement: 'crypto-master'
                },
                {
                    id: 'crypto-node-2',
                    title: 'RSA Âä†ÂØÜÊºîÁ§∫',
                    description: 'RSA Âä†ÂØÜÁÆóÊ≥ïÁöÑÊºîÁ§∫ÁªàÁ´Ø‰∏äÔºå‰∏Ä‰∏™Âä†ÂØÜÂêéÁöÑÊ∂àÊÅØÁ≠âÂæÖËß£ÂØÜ„ÄÇ',
                    action: 'Ëß£ÂØÜ RSA Ê∂àÊÅØ',
                    puzzle: {
                        type: 'rsa',
                        difficulty: 5,
                        description: 'Âä†ÂØÜÊ∂àÊÅØ: 123456. ‰ΩøÁî®ÂÖ¨Èí• (e=3, n=3233) ÂíåÁßÅÈí• (d=2753) Ëß£ÂØÜËøô‰∏™Ê∂àÊÅØ„ÄÇ',
                        answer: 'HELLO'
                    },
                    clue: 'crypto-clue-2',
                    achievement: 'rsa-cracker'
                }
            ]
        };

        // ÂàùÂßãÂåñÂáΩÊï∞
        function initGame() {
            // Âä†ËΩΩÂä®Áîª
            const loadingBar = document.getElementById('loading-bar');
            let loadInterval = setInterval(() => {
                const width = parseInt(loadingBar.style.width || '0%') + 5;
                loadingBar.style.width = `${width}%`;
                if (width >= 100) {
                    clearInterval(loadInterval);
                    setTimeout(() => {
                        document.getElementById('splash-screen').style.opacity = '0';
                        setTimeout(() => {
                            document.getElementById('splash-screen').style.display = 'none';
                            document.getElementById('game-map').style.display = 'flex';
                            gameState.loaded = true;
                            updateMapDisplay();
                            updateUI();
                        }, 500);
                    }, 500);
                }
            }, 200);

            // ÂºÄÂßãÊåâÈíÆÁÇπÂáª‰∫ã‰ª∂
            document.getElementById('start-btn').addEventListener('click', () => {
                document.getElementById('start-btn').disabled = true;
                // Ê®°ÊãüÂä†ËΩΩËøáÁ®ã
                const loadingBar = document.getElementById('loading-bar');
                let width = 0;
                const loadInterval = setInterval(() => {
                    width += 5;
                    loadingBar.style.width = `${width}%`;
                    if (width >= 100) {
                        clearInterval(loadInterval);
                        setTimeout(() => {
                            document.getElementById('splash-screen').style.opacity = '0';
                            setTimeout(() => {
                                document.getElementById('splash-screen').style.display = 'none';
                                document.getElementById('game-map').style.display = 'flex';
                                gameState.loaded = true;
                                updateMapDisplay();
                                updateUI();
                            }, 500);
                        }, 500);
                    }
                }, 100);
            });

            // Êó∂Èó¥ÂàáÊç¢ÊåâÈíÆ
            document.getElementById('time-toggle').addEventListener('click', () => {
                gameState.currentTime = gameState.currentTime === 'day' ? 'night' : 'day';
                document.getElementById('time-display').textContent = `Á≥ªÁªüÊó∂Èó¥: ${gameState.currentTime === 'day' ? 'ÁôΩÂ§©' : 'Â§úÊôö'}`;
                checkAchievement('night-owl');
                updateUI();
            });

            // ËøîÂõûÂú∞ÂõæÊåâÈíÆ
            document.getElementById('back-btn').addEventListener('click', () => {
                document.getElementById('exploration-screen').style.display = 'none';
                document.getElementById('game-map').style.display = 'flex';
                gameState.currentLocation = null;
                updateMapDisplay();
            });

            // ÂÖ≥Èó≠Ë∞úÈ¢òÊåâÈíÆ
            document.getElementById('close-puzzle').addEventListener('click', () => {
                document.getElementById('puzzle-screen').style.display = 'none';
                document.getElementById('exploration-screen').style.display = 'flex';
            });

            // Êèê‰∫§Á≠îÊ°àÊåâÈíÆ
            document.getElementById('submit-answer').addEventListener('click', () => {
                const answer = document.getElementById('puzzle-answer').value.trim();
                const currentPuzzle = getCurrentPuzzle();
                if (answer.toLowerCase() === currentPuzzle.answer.toLowerCase()) {
                    // ÂõûÁ≠îÊ≠£Á°Æ
                    solvePuzzle(answer);
                } else {
                    // ÂõûÁ≠îÈîôËØØ
                    showModal('ÈîôËØØ', 'Á≠îÊ°à‰∏çÊ≠£Á°ÆÔºåËØ∑ÈáçËØï„ÄÇ', () => {
                        document.getElementById('puzzle-answer').value = '';
                        document.getElementById('puzzle-answer').focus();
                    });
                }
            });

            // Ê®°ÊÄÅÊ°ÜÊåâÈíÆ
            document.getElementById('modal-btn').addEventListener('click', () => {
                document.getElementById('modal').style.display = 'none';
            });

            // ÂàùÂßãÂåñÂú∞ÂõæËäÇÁÇπÁÇπÂáª‰∫ã‰ª∂
            initMapNodes();

            // ÂàùÂßãÂåñÊàêÂ∞±ÊòæÁ§∫
            updateAchievements();

            // ÂàùÂßãÂåñÁ∫øÁ¥¢ÊòæÁ§∫
            updateClues();
        }

        // ÂàùÂßãÂåñÂú∞ÂõæËäÇÁÇπÁÇπÂáª‰∫ã‰ª∂
        function initMapNodes() {
            const nodes = document.querySelectorAll('.map-node');
            nodes.forEach(node => {
                node.addEventListener('click', () => {
                    const nodeId = node.getAttribute('data-node');
                    if (!gameState.unlockedNodes.includes(nodeId) && nodeId !== 'main-hub') {
                        // ËäÇÁÇπÊú™Ëß£ÈîÅ
                        showModal('ËäÇÁÇπÈîÅÂÆö', 'Ëøô‰∏™ËäÇÁÇπÂ∞öÊú™Ëß£ÈîÅÔºåÊé¢Á¥¢ÂÖ∂‰ªñÂå∫ÂüüËé∑ÂèñÁ∫øÁ¥¢„ÄÇ', () => {
                            // Êó†Êìç‰Ωú
                        });
                        return;
                    }
                    // ËøõÂÖ•Êé¢Á¥¢Ê®°Âºè
                    enterExplorationMode(nodeId);
                });
            });
        }

        // ËøõÂÖ•Êé¢Á¥¢Ê®°Âºè
        function enterExplorationMode(nodeId) {
            gameState.currentLocation = nodeId;
            document.getElementById('game-map').style.display = 'none';
            document.getElementById('exploration-screen').style.display = 'flex';
            document.getElementById('location-name').textContent = getNodeType(nodeId);
            
            // Âä†ËΩΩÊé¢Á¥¢ËäÇÁÇπ
            loadExplorationNodes(nodeId);
        }

        // Ëé∑ÂèñËäÇÁÇπÁ±ªÂûãÂêçÁß∞
        function getNodeType(nodeId) {
            const types = {
                'main-hub': '‰∏≠ÂøÉÊû¢Á∫Ω',
                'data-center': 'Êï∞ÊçÆ‰∏≠ÂøÉ',
                'security-hub': 'ÁΩëÁªúÂÆâÂÖ®‰∏≠ÂøÉ',
                'ai-lab': 'AI ÂÆûÈ™åÂÆ§',
                'crypto-vault': 'ÂØÜÁ†ÅÂ≠¶ÈáëÂ∫ì'
            };
            return types[nodeId] || 'Êú™Áü•Âå∫Âüü';
        }

        // Âä†ËΩΩÊé¢Á¥¢ËäÇÁÇπ
        function loadExplorationNodes(nodeId) {
            const explorationContent = document.getElementById('exploration-content');
            explorationContent.innerHTML = '';
            
            const nodes = explorationNodesData[nodeId];
            if (!nodes) return;
            
            nodes.forEach(node => {
                const nodeEl = document.createElement('div');
                nodeEl.className = `exploration-node ${gameState.puzzlesSolved[nodeId] && gameState.puzzlesSolved[nodeId].includes(node.id) ? 'node-completed' : ''}`;
                
                const titleEl = document.createElement('div');
                titleEl.className = 'node-title';
                titleEl.innerHTML = `<span class="node-icon">üîç</span>${node.title}`;
                
                const descEl = document.createElement('div');
                descEl.className = 'node-description';
                descEl.textContent = node.description;
                
                const actionEl = document.createElement('div');
                actionEl.className = 'node-action';
                
                if (node.puzzle) {
                    if (!gameState.puzzlesSolved[nodeId] || !gameState.puzzlesSolved[nodeId].includes(node.id)) {
                        const btn = document.createElement('button');
                        btn.className = 'action-btn';
                        btn.textContent = node.action;
                        btn.addEventListener('click', () => {
                            openPuzzle(node.puzzle, node.id, nodeId, node.clue, node.achievement);
                        });
                        actionEl.appendChild(btn);
                    }
                } else {
                    const btn = document.createElement('button');
                    btn.className = 'action-btn';
                    btn.textContent = node.action;
                    btn.addEventListener('click', () => {
                        showModal('‰ø°ÊÅØ', node.description, () => {
                            // Êó†Êìç‰Ωú
                        });
                    });
                    actionEl.appendChild(btn);
                }
                
                nodeEl.appendChild(titleEl);
                nodeEl.appendChild(descEl);
                nodeEl.appendChild(actionEl);
                explorationContent.appendChild(nodeEl);
            });
        }

        // ÊâìÂºÄË∞úÈ¢ò
        function openPuzzle(puzzleData, puzzleId, nodeId, clueId, achievementId) {
            document.getElementById('exploration-screen').style.display = 'none';
            document.getElementById('puzzle-screen').style.display = 'flex';
            
            document.getElementById('puzzle-title').textContent = puzzleData.description.split('.')[0];
            document.getElementById('puzzle-description').textContent = puzzleData.description;
            
            // Ê†πÊçÆË∞úÈ¢òÁ±ªÂûãËÆæÁΩÆÁïåÈù¢
            setupPuzzleInterface(puzzleData.type, puzzleData.difficulty);
            
            // ‰øùÂ≠òÂΩìÂâçË∞úÈ¢ò‰ø°ÊÅØ
            currentPuzzleInfo = {
                id: puzzleId,
                nodeId: nodeId,
                clueId: clueId,
                achievementId: achievementId
            };
            
            // Ê∏ÖÁ©∫Á≠îÊ°àËæìÂÖ•Ê°Ü
            document.getElementById('puzzle-answer').value = '';
            document.getElementById('puzzle-answer').focus();
        }

        // ËÆæÁΩÆË∞úÈ¢òÁïåÈù¢
        function setupPuzzleInterface(type, difficulty) {
            const puzzleInterface = document.getElementById('puzzle-interface');
            puzzleInterface.innerHTML = '';
            
            // Ê∑ªÂä†ÈöæÂ∫¶ÊåáÁ§∫Âô®
            const difficultyEl = document.createElement('div');
            difficultyEl.style.textAlign = 'center';
            difficultyEl.style.marginBottom = '15px';
            difficultyEl.innerHTML = `ÈöæÂ∫¶: ${'‚òÖ'.repeat(difficulty)}`;
            puzzleInterface.appendChild(difficultyEl);
            
            // Ê†πÊçÆË∞úÈ¢òÁ±ªÂûãËÆæÁΩÆ‰∏çÂêåÁïåÈù¢
            switch(type) {
                case 'caesar':
                    const caesarEl = document.createElement('div');
                    caesarEl.style.textAlign = 'center';
                    caesarEl.style.fontSize = '1.2em';
                    caesarEl.style.fontFamily = '"Courier New", monospace';
                    caesarEl.innerHTML = 'Uifsf jt b tfdsfu dpefefs ibufdmfjoft.';
                    puzzleInterface.appendChild(caesarEl);
                    break;
                case 'binary':
                    const binaryEl = document.createElement('div');
                    binaryEl.style.textAlign = 'center';
                    binaryEl.style.fontSize = '1.2em';
                    binaryEl.style.fontFamily = '"Courier New", monospace';
                    binaryEl.innerHTML = '01001000 01100101 01101100 01101100 01101111 00100000 01010111 01101111 011100kl';
                    puzzleInterface.appendChild(binaryEl);
                    break;
                case 'regex':
                    const regexEl = document.createElement('div');
                    regexEl.style.textAlign = 'center';
                    regexEl.style.fontSize = '1.2em';
                    regexEl.style.fontFamily = '"Courier New", monospace';
                    regexEl.innerHTML = 'D[T][A-P]_[0-9]{3}_[A-Z]{3}';
                    puzzleInterface.appendChild(regexEl);
                    break;
                case 'ip-calc':
                    const ipEl = document.createElement('div');
                    ipEl.style.textAlign = 'center';
                    ipEl.style.fontSize = '1.2em';
                    ipEl.style.fontFamily = '"Courier New", monospace';
                    ipEl.innerHTML = '192.168.1.255/24';
                    puzzleInterface.appendChild(ipEl);
                    break;
                case 'base64':
                    const base64El = document.createElement('div');
                    base64El.style.textAlign = 'center';
                    base64El.style.fontSize = '1.2em';
                    base64El.style.fontFamily = '"Courier New", monospace';
                    base64El.innerHTML = 'QW5jb3Z1cnJhbl9maWxlLnR4dA==';
                    puzzleInterface.appendChild(base64El);
                    break;
                case 'sequence':
                    const sequenceEl = document.createElement('div');
                    sequenceEl.style.textAlign = 'center';
                    sequenceEl.style.fontSize = '1.2em';
                    sequenceEl.style.fontFamily = '"Courier New", monospace';
                    sequenceEl.innerHTML = '0, 1, 1, 2, 3, 5, 8, 13, ?';
                    puzzleInterface.appendChild(sequenceEl);
                    break;
                case 'xor':
                    const xorEl = document.createElement('div');
                    xorEl.style.textAlign = 'center';
                    xorEl.style.fontSize = '1.2em';
                    xorEl.style.fontFamily = '"Courier New", monospace';
                    xorEl.innerHTML = 'XOR Èó®ÁöÑËæìÂá∫ÊòØ ? ÂΩìËæìÂÖ•ÊòØ 1 Âíå 1';
                    puzzleInterface.appendChild(xorEl);
                    break;
                case 'md5':
                    const md5El = document.createElement('div');
                    md5El.style.textAlign = 'center';
                    md5El.style.fontSize = '1.2em';
                    md5El.style.fontFamily = '"Courier New", monospace';
                    md5El.innerHTML = '68e1f5a3f9f8c9f8c9f8c9f8c9f8c9f8';
                    puzzleInterface.appendChild(md5El);
                    break;
                case 'rsa':
                    const rsaEl = document.createElement('div');
                    rsaEl.style.textAlign = 'center';
                    rsaEl.style.fontSize = '1.2em';
                    rsaEl.style.fontFamily = '"Courier New", monospace';
                    rsaEl.innerHTML = 'Âä†ÂØÜÊ∂àÊÅØ: 123456<br>ÂÖ¨Èí• (e=3, n=3233)<br>ÁßÅÈí• (d=2753)';
                    rsaEl.innerHTML = rsaEl.innerHTML.replace(/\n/g, '<br>');
                    puzzleInterface.appendChild(rsaEl);
                    break;
                default:
                    const defaultEl = document.createElement('div');
                    defaultEl.style.textAlign = 'center';
                    defaultEl.style.fontSize = '1.2em';
                    defaultEl.style.fontFamily = '"Courier New", monospace';
                    defaultEl.textContent = 'ËØ∑Ê†πÊçÆÊèêÁ§∫ÂõûÁ≠îÈóÆÈ¢ò';
                    puzzleInterface.appendChild(defaultEl);
            }
        }

        // Ëß£ÂÜ≥Ë∞úÈ¢ò
        function solvePuzzle(answer) {
            const { id, nodeId, clueId, achievementId } = currentPuzzleInfo;
            
            // Ê∑ªÂä†Ë∞úÈ¢òÂà∞Â∑≤Ëß£ÂÜ≥ÂàóË°®
            if (!gameState.puzzlesSolved[nodeId]) {
                gameState.puzzlesSolved[nodeId] = [];
            }
            gameState.puzzlesSolved[nodeId].push(id);
            
            // Â¶ÇÊûúÊúâÁ∫øÁ¥¢ÔºåÊ∑ªÂä†Á∫øÁ¥¢
            if (clueId) {
                const clue = cluesData.find(c => c.id === clueId);
                if (clue && !gameState.clues.includes(clueId)) {
                    gameState.clues.push(clueId);
                    showModal('ÊÅ≠Âñú', `‰Ω†Ëß£ÂºÄ‰∫ÜË∞úÈ¢òÂπ∂Ëé∑Âæó‰∫ÜÁ∫øÁ¥¢: ${clue.name}`, () => {
                        document.getElementById('puzzle-screen').style.display = 'none';
                        document.getElementById('exploration-screen').style.display = 'flex';
                        updateClues();
                        checkAchievement('clue-collector');
                        checkAchievement('puzzle-solver');
                    });
                } else {
                    showModal('ÊÅ≠Âñú', '‰Ω†Ëß£ÂºÄ‰∫ÜË∞úÈ¢ò!', () => {
                        document.getElementById('puzzle-screen').style.display = 'none';
                        document.getElementById('exploration-screen').style.display = 'flex';
                        checkAchievement('puzzle-solver');
                    });
                }
            } else {
                showModal('ÊÅ≠Âñú', '‰Ω†Ëß£ÂºÄ‰∫ÜË∞úÈ¢ò!', () => {
                    document.getElementById('puzzle-screen').style.display = 'none';
                    document.getElementById('exploration-screen').style.display = 'flex';
                    checkAchievement('puzzle-solver');
                });
            }
            
            // Â¶ÇÊûúÊúâÊàêÂ∞±ÔºåËß£ÈîÅÊàêÂ∞±
            if (achievementId) {
                unlockAchievement(achievementId);
            }
            
            // Êõ¥Êñ∞Êé¢Á¥¢ÁïåÈù¢
            loadExplorationNodes(nodeId);
        }

        // ÊòæÁ§∫Ê®°ÊÄÅÊ°Ü
        function showModal(title, message, callback) {
            document.getElementById('modal-title').textContent = title;
            document.getElementById('modal-message').textContent = message;
            document.getElementById('modal').style.display = 'flex';
            
            // ËÆæÁΩÆÂõûË∞É
            const modalBtn = document.getElementById('modal-btn');
            const originalCallback = modalBtn.onclick;
            modalBtn.onclick = function() {
                if (originalCallback) originalCallback.call(this);
                if (callback) callback();
            };
        }

        // Ëß£ÈîÅÊàêÂ∞±
        function unlockAchievement(achievementId) {
            if (!gameState.achievements.includes(achievementId)) {
                gameState.achievements.push(achievementId);
                
                // ÊòæÁ§∫ÊàêÂ∞±Ëé∑ÂæóÈÄöÁü•
                setTimeout(() => {
                    const achievement = achievementsData.find(a => a.id === achievementId);
                    if (achievement) {
                        showModal('ÊàêÂ∞±Ëß£ÈîÅ', `‰Ω†Ëé∑Âæó‰∫ÜÊàêÂ∞±: ${achievement.name}<br>${achievement.description}`, () => {
                            updateAchievements();
                        });
                    }
                }, 500);
                
                // Ê£ÄÊü•ÊòØÂê¶Ëß£ÈîÅ‰∫ÜÊâÄÊúâÊàêÂ∞±
                checkPerfectExplorer();
            }
        }

        // Ê£ÄÊü•ÊòØÂê¶Ëß£ÈîÅÊâÄÊúâËäÇÁÇπ
        function checkPerfectExplorer() {
            const allNodes = ['main-hub', 'data-center', 'security-hub', 'ai-lab', 'crypto-vault'];
            const allUnlocked = allNodes.every(node => gameState.unlockedNodes.includes(node));
            if (allUnlocked && !gameState.achievements.includes('perfect-explorer')) {
                unlockAchievement('perfect-explorer');
            }
        }

        // Ê£ÄÊü•ÊàêÂ∞±Êù°‰ª∂
        function checkAchievement(achievementId) {
            const achievement = achievementsData.find(a => a.id === achievementId);
            if (!achievement || gameState.achievements.includes(achievementId)) return;
            
            switch(achievementId) {
                case 'clue-collector':
                    if (gameState.clues.length >= 5) {
                        unlockAchievement(achievementId);
                    }
                    break;
                case 'puzzle-solver':
                    let totalPuzzles = 0;
                    for (const node in gameState.puzzlesSolved) {
                        if (gameState.puzzlesSolved[node]) {
                            totalPuzzles += gameState.puzzlesSolved[node].length;
                        }
                    }
                    if (totalPuzzles >= 5) {
                        unlockAchievement(achievementId);
                    }
                    break;
                case 'night-owl':
                    if (gameState.currentTime === 'night') {
                        unlockAchievement(achievementId);
                    }
                    break;
                default:
                    // ÂÖ∂‰ªñÊàêÂ∞±Êù°‰ª∂Ê£ÄÊü•
                    break;
            }
        }

        // Êõ¥Êñ∞ÊàêÂ∞±ÊòæÁ§∫
        function updateAchievements() {
            const achievementsContainer = document.getElementById('achievements-container');
            achievementsContainer.innerHTML = '';
            
            achievementsData.forEach(achievement => {
                const hasAchievement = gameState.achievements.includes(achievement.id);
                const isUnlocked = hasAchievement || !achievement.hidden;
                
                if (isUnlocked) {
                    const achievementEl = document.createElement('div');
                    achievementEl.className = `achievement-item ${hasAchievement ? '' : 'achievement-locked'}`;
                    
                    const iconEl = document.createElement('div');
                    iconEl.className = 'achievement-icon';
                    iconEl.textContent = achievement.icon;
                    
                    const textEl = document.createElement('div');
                    textEl.className = 'achievement-text';
                    textEl.innerHTML = `${achievement.name} ${'‚òÖ'.repeat(achievement.difficulty)}`;
                    
                    achievementEl.appendChild(iconEl);
                    achievementEl.appendChild(textEl);
                    achievementsContainer.appendChild(achievementEl);
                }
            });
        }

        // Êõ¥Êñ∞Á∫øÁ¥¢ÊòæÁ§∫
        function updateClues() {
            const cluesContainer = document.getElementById('clues-container');
            cluesContainer.innerHTML = '';
            
            gameState.clues.forEach(clueId => {
                const clue = cluesData.find(c => c.id === clueId);
                if (clue) {
                    const clueEl = document.createElement('div');
                    clueEl.className = 'clue-item';
                    
                    const iconEl = document.createElement('div');
                    iconEl.className = 'clue-icon';
                    iconEl.textContent = clue.icon;
                    
                    const textEl = document.createElement('div');
                    textEl.className = 'clue-text';
                    textEl.innerHTML = `${clue.name}: ${clue.description}`;
                    
                    clueEl.appendChild(iconEl);
                    clueEl.appendChild(textEl);
                    cluesContainer.appendChild(clueEl);
                }
            });
        }

        // Êõ¥Êñ∞Âú∞ÂõæÊòæÁ§∫
        function updateMapDisplay() {
            const nodes = document.querySelectorAll('.map-node');
            nodes.forEach(node => {
                const nodeId = node.getAttribute('data-node');
                if (gameState.unlockedNodes.includes(nodeId)) {
                    node.classList.remove('map-node-locked');
                } else {
                    node.classList.add('map-node-locked');
                }
            });
            
            // Êõ¥Êñ∞Êó∂Èó¥ÊòæÁ§∫
            document.getElementById('time-display').textContent = `Á≥ªÁªüÊó∂Èó¥: ${gameState.currentTime === 'day' ? 'ÁôΩÂ§©' : 'Â§úÊôö'}`;
        }

        // Êõ¥Êñ∞Áî®Êà∑ÁïåÈù¢
        function updateUI() {
            updateMapDisplay();
            updateAchievements();
            updateClues();
        }

        // Ëé∑ÂèñÂΩìÂâçË∞úÈ¢ò‰ø°ÊÅØ
        let currentPuzzleInfo = null;

        // Ëé∑ÂèñÂΩìÂâçË∞úÈ¢ò
        function getCurrentPuzzle() {
            const { nodeId, id } = currentPuzzleInfo;
            if (!nodeId || !id || !explorationNodesData[nodeId]) return null;
            
            const node = explorationNodesData[nodeId].find(n => n.id === id);
            if (!node || !node.puzzle) return null;
            
            return node.puzzle;
        }

        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂàùÂßãÂåñÊ∏∏Êàè
        window.addEventListener('load', initGame);
    </script>
</body>
</html>